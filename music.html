<html>
	<head>
		<title>{{.Name}}</title>
		<style>
body {
	padding: 0;
	margin: 0;
}
main {
	display: flex;
	flex-direction: column;
	height: 100vh;
}
audio { 
	width: 100%;
}
main #img {
	flex-grow: 1;
	position: relative;
}
main #img img {
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
}
		</style>
	</head>
	<body>
		<main>
			<div id="img">
				<img src="/{{.Id}}/0.png">
			</div>
			<audio src="{{.Audio}}" controls></audio>
		</main>

		<script>
		var map = {{.Map}};
		var arr = [];
		for (var key in map) {
			arr.push([key, map[key]]);
		}
		arr = arr.map(function(v, _) {
			v[0] = v[0] | 0;
			return v; }).sort(function(a, b) {
				return a[0] - b[0];		
			});

		var audio = document.getElementsByTagName("audio")[0];
		var img = document.getElementsByTagName("img")[0];
		audio.ontimeupdate = function(e) {
			var n = 0;
			if (this.currentTime*1000 < arr[0][0]) {
				n = 0;
			} else for (var i = 0; i < arr.length; i++) {
				if (arr[i][0] <= this.currentTime * 1000 && (
					arr[i + 1] == undefined ||
					arr[i + 1][0] > this.currentTime * 1000)) {
					n = arr[i][1];
				}
			}			
			if (!img.src.endsWith("/{{.Id}}/" + n + ".png"))
				img.src = "/{{.Id}}/" + n + ".png";
		}
		</script>
	</body>
</html>