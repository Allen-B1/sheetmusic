<html>
	<head>
		<title>{{.Name}}</title>
	</head>
	<body>
		<audio src="{{.Audio}}" controls></audio>
		<img src="/{{.Id}}/0.png">

		<script>
		var map = {{.Map}};
		var arr = [];
		for (var key in map) {
			arr.push([key, map[key]]);
		}
		arr = arr.map(function(v, _) {
			v[0] = v[0] | 0;
			return v; }).sort(function(a, b) {
				return a[0] - b[0];		
			});

		var audio = document.getElementsByTagName("audio")[0];
		var img = document.getElementsByTagName("img")[0];
		audio.ontimeupdate = function(e) {
			var n = 0;
			if (this.currentTime*1000 < arr[0][0]) {
				n = 0;
			} else for (var i = 0; i < arr.length; i++) {
				if (arr[i][0] <= this.currentTime * 1000 && (
					arr[i + 1] == undefined ||
					arr[i + 1][0] > this.currentTime * 1000)) {
					n = arr[i][1];
				}
			}			
			if (img.src != "/{{.Id}}/" + n + ".png")
				img.src = "/{{.Id}}/" + n + ".png";
		}
		</script>
	</body>
</html>